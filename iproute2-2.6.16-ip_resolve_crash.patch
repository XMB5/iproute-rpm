--- iproute2-2.6.16-060323/lib/utils.c.crash	2005-09-01 21:21:50.000000000 +0200
+++ iproute2-2.6.16-060323/lib/utils.c	2006-09-19 13:47:26.000000000 +0200
@@ -439,7 +439,7 @@
 		len = 4;
 	}
 
-	hash = addr[len-1] ^ addr[len-2] ^ addr[len-3] ^ addr[len-4];
+	hash = (addr[len-1] ^ addr[len-2] ^ addr[len-3] ^ addr[len-4]) & 0xff;
 
 	for (n = nht[hash]; n; n = n->next) {
 		if (n->addr.family == af &&
